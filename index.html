<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ¤– AI ê¸°ìˆ  íŠ¸ë Œë“œ ëŒ€ì‹œë³´ë“œ</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: #f0f2f5; margin: 0; }
        .container { max-width: 800px; margin: 20px auto; padding: 20px; background: white; box-shadow: 0 1px 3px rgba(0,0,0,0.12); border-radius: 8px; }
        .header { text-align: center; border-bottom: 1px solid #e0e0e0; padding-bottom: 20px; margin-bottom: 20px; }
        .header h1 { margin: 0; color: #1c1e21; }
        .header p { color: #606770; }
        .main-button { width: 100%; background: #1877f2; color: white; border: none; padding: 15px; font-size: 16px; border-radius: 6px; cursor: pointer; font-weight: bold; margin-bottom: 20px; transition: background-color 0.2s; }
        .main-button:hover { background: #166fe5; }
        .main-button:disabled { background: #ccc; cursor: not-allowed; }
        #result-area .card { border: 1px solid #ddd; border-radius: 8px; padding: 15px; margin-bottom: 15px; background: #fff; transition: box-shadow 0.2s; }
        .card:hover { box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
        .card-title a { color: #0d6efd; text-decoration: none; font-weight: 600; font-size: 1.1em; }
        .card-title a:hover { text-decoration: underline; }
        .card-meta { font-size: 0.85em; color: #6c757d; margin-top: 8px; display: flex; align-items: center; }
        .source-tag { display: inline-block; padding: 3px 8px; font-size: 0.75em; border-radius: 12px; color: white; margin-right: 10px; }
        .tag-github { background-color: #333; }
        .tag-openai { background-color: #10a37f; }
        .tag-google { background-color: #ea4335; }
        .tag-huggingface { background-color: #ffd21e; color: #333; }
        .tag-hackernews { background-color: #ff6600; }
        .tag-default { background-color: #6c757d; }
        .status-message { text-align: center; padding: 40px 20px; color: #666; font-size: 1.1em; border: 2px dashed #ddd; border-radius: 8px; }
        .error-message { background: #f8d7da; color: #721c24; padding: 15px; border-radius: 8px; margin-top: 20px; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ¤– AI ê¸°ìˆ  íŠ¸ë Œë“œ ëŒ€ì‹œë³´ë“œ</h1>
            <p>ë§¤ì¼ ì—…ë°ì´íŠ¸ë˜ëŠ” ìµœì‹  AI ë„êµ¬, ê¸°ìˆ , ì•„ì´ë””ì–´ë¥¼ í™•ì¸í•˜ì„¸ìš”.</p>
        </div>
        
        <button class="main-button" id="fetch-button" onclick="fetchContent()">ğŸš€ ìµœì‹  ê¸°ìˆ  íŠ¸ë Œë“œ ê°€ì ¸ì˜¤ê¸°</button>
        
        <div id="result-area">
            <div class="status-message" id="initial-message">ë²„íŠ¼ì„ ëˆŒëŸ¬ AI ê¸°ìˆ  íŠ¸ë Œë“œë¥¼ í™•ì¸í•˜ì„¸ìš”.</div>
        </div>
        <div id="last-updated" style="text-align: center; font-size: 0.8em; color: #888; margin-top: 20px;"></div>
    </div>

    <script>
        // ==================================================================
        // !!! ì¤‘ìš”: ì´ URLì„ ë³¸ì¸ì˜ ì‹¤ì œ URLë¡œ êµì²´í•´ì£¼ì„¸ìš” !!!
        // Cloud Run > get-latest-content ì„œë¹„ìŠ¤ ìƒì„¸ ì •ë³´ì—ì„œ í™•ì¸ ê°€ëŠ¥í•©ë‹ˆë‹¤.
        // ==================================================================
        const API_URL = 'https://get-latest-content-1092892769102.us-central1.run.app';

        async function fetchContent() {
            const button = document.getElementById('fetch-button');
            const resultArea = document.getElementById('result-area');
            const lastUpdatedDiv = document.getElementById('last-updated');

            button.disabled = true;
            button.textContent = 'ğŸ”„ ìµœì‹  ì •ë³´ ë¡œë”© ì¤‘...';
            resultArea.innerHTML = '<div class="status-message">ì½˜í…ì¸ ë¥¼ ê°€ì ¸ì˜¤ê³  ìˆìŠµë‹ˆë‹¤...</div>';
            lastUpdatedDiv.innerHTML = '';

            try {
                const response = await fetch(API_URL);
                const data = await response.json();

                if (data.status === 'ERROR' || !response.ok) {
                    // ì„œë²„ê°€ ë³´ë‚¸ ì—ëŸ¬ ë©”ì‹œì§€ê°€ ìˆê±°ë‚˜, ì‘ë‹µ ìì²´ê°€ ì‹¤íŒ¨í•œ ê²½ìš°
                    throw new Error(data.message || `ì„œë²„ ì‘ë‹µ ì˜¤ë¥˜: ${response.status}`);
                }
                
                if (data.content && data.content.length > 0) {
                    let contentHtml = data.content.map(createCard).join('');
                    resultArea.innerHTML = contentHtml;
                    const updatedDate = new Date(data.last_updated).toLocaleString('ko-KR');
                    lastUpdatedDiv.innerHTML = `ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸: ${updatedDate}`;

                } else {
                    resultArea.innerHTML = '<div class="status-message">ìµœê·¼ 24ì‹œê°„ ë‚´ì— ìˆ˜ì§‘ëœ ìƒˆë¡œìš´ ì½˜í…ì¸ ê°€ ì—†ìŠµë‹ˆë‹¤.</div>';
                    const updatedDate = new Date(data.last_updated).toLocaleString('ko-KR');
                    lastUpdatedDiv.innerHTML = `ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸: ${updatedDate}`;
                }

            } catch (error) {
                resultArea.innerHTML = `<div class="error-message"><strong>ì˜¤ë¥˜ ë°œìƒ:</strong> ${error.message}</div>`;
                console.error('Fetch error:', error);
            } finally {
                button.disabled = false;
                button.textContent = 'ğŸš€ ìµœì‹  ê¸°ìˆ  íŠ¸ë Œë“œ ê°€ì ¸ì˜¤ê¸°';
            }
        }

        function createCard(item) {
            const source_lower = item.source.toLowerCase();
            let tagClass = 'tag-default';
            if (source_lower.includes('github') || source_lower.includes('langchain') || source_lower.includes('llama')) tagClass = 'tag-github';
            if (source_lower.includes('openai')) tagClass = 'tag-openai';
            if (source_lower.includes('google')) tagClass = 'tag-google';
            if (source_lower.includes('hugging')) tagClass = 'tag-huggingface';
            if (source_lower.includes('hacker')) tagClass = 'tag-hackernews';
            
            return `
                <div class="card">
                    <div class="card-title">
                        <a href="${item.link}" target="_blank" rel="noopener noreferrer">${item.title}</a>
                    </div>
                    <div class="card-meta">
                        <span class="source-tag ${tagClass}">${item.source}</span>
                        <span>${item.published_str} UTC</span>
                    </div>
                </div>
            `;
        }
    </script>
</body>
</html>
